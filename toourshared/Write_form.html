<!DOCTYPE html>




<html xmlns="http://www.w3.org/1999/xhtml">

<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.11/dist/summernote-bs4.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <script src='https://www.google.com/recaptcha/api.js'></script>
    <title></title>
    <style>
        .map_wrap {
            width: 100%;
            vertical-align: middle;
            margin-bottom: 30px;
        }

        .modes {
            top: 10px;
            left: 10px;
            z-index: 1;
        }

        #drawingMap {
            top: 0px;
            width: auto;
            height: 700px;
            text-align: center;
        }


        .map_wrap,
        .map_wrap * {
            //margin: 10;
            padding: 0;
            font-family: 'Malgun Gothic', dotum, 'ë‹ì›€', sans-serif;
            font-size: 12px;
        }

        .map_wrap a,
        .map_wrap a:hover,
        .map_wrap a:active {
            color: #000;
            text-decoration: none;
        }

        .map_wrap {
            position: relative;
            width: 100%;
            height: 500px;
        }



        #menu_wrap {
            margin: 10px 0 30px 10px;
            padding: 5px;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.7);
            z-index: 1;
            font-size: 12px;
            border-radius: 10px;
        }

        .bg_white {
            background: #fff;
        }

        #menu_wrap hr {
            display: block;
            height: 1px;
            border: 0;
            border-top: 2px solid #5F5F5F;
            margin: 3px 0;
        }

        #menu_wrap .option {
            text-align: center;
        }

        #menu_wrap .option p {
            margin: 10px 0;
        }

        #menu_wrap .option button {
            margin-left: 5px;
        }

        #placesList li {
            list-style: none;
        }

        #placesList .item {
            position: relative;
            border-bottom: 1px solid #888;
            overflow: hidden;
            cursor: pointer;
            min-height: 65px;
        }

        #placesList .item span {
            display: block;
            margin-top: 4px;
        }

        #placesList .item h5,
        #placesList .item .info {
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }

        #placesList .item .info {
            padding: 10px 0 10px 55px;
        }

        #placesList .info .gray {
            color: #8a8a8a;
        }

        #placesList .info .jibun {
            padding-left: 26px;
            background: url(http://t1.daumcdn.net/localimg/localimages/07/mapapidoc/places_jibun.png) no-repeat;
        }

        #placesList .info .tel {
            color: #009900;
        }

        #placesList .item .markerbg {
            float: left;
            position: absolute;
            width: 36px;
            height: 37px;
            margin: 10px 0 0 10px;
            background: url(http://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_number_blue.png) no-repeat;
        }

        #placesList .item .marker_1 {
            background-position: 0 -10px;
        }

        #placesList .item .marker_2 {
            background-position: 0 -56px;
        }

        #placesList .item .marker_3 {
            background-position: 0 -102px
        }

        #placesList .item .marker_4 {
            background-position: 0 -148px;
        }

        #placesList .item .marker_5 {
            background-position: 0 -194px;
        }

        #placesList .item .marker_6 {
            background-position: 0 -240px;
        }

        #placesList .item .marker_7 {
            background-position: 0 -286px;
        }

        #placesList .item .marker_8 {
            background-position: 0 -332px;
        }

        #placesList .item .marker_9 {
            background-position: 0 -378px;
        }

        #placesList .item .marker_10 {
            background-position: 0 -423px;
        }

        #placesList .item .marker_11 {
            background-position: 0 -470px;
        }

        #placesList .item .marker_12 {
            background-position: 0 -516px;
        }

        #placesList .item .marker_13 {
            background-position: 0 -562px;
        }

        #placesList .item .marker_14 {
            background-position: 0 -608px;
        }

        #placesList .item .marker_15 {
            background-position: 0 -654px;
        }

        #pagination {
            margin: 10px auto;
            text-align: center;
        }

        #pagination a {
            display: inline-block;
            margin-right: 10px;
        }

        #pagination .on {
            font-weight: bold;
            cursor: default;
            color: #777;
        }


        < !-- ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´ ìŠ¤íƒ€ì¼-->.card {
            border: 1px outset black;
            border-radius: 12px;
            //font: bold 1rem sans-serif;
            width: 300px;
        }

        .card-header {
            background-color: rgb(255, 212, 94);
            font-weight: bold;
            font-family: 'Malgun Gothic', dotum, 'ë‹ì›€', sans-serif;
            text-align: center;
            font-size: 20px;
            padding: 0px;

        }

        .card-body {
            font-family: 'Malgun Gothic', dotum, 'ë‹ì›€', sans-serif;
            text-align: center;
            font-size: 18px;
            overflow: auto;
            padding: 0px;
        }

        .card-body-li {
            font-size: 15px;
            list-style: none;
            padding-left: 0px;


        }

        < !-- modal-cost and TravelRoute-->< !-- modal-cost and TravelRoute-->.modal-cost {

            display: flex;
            flex-direction: row-reverse;
            width: 100%;

        }

        #travelRoute {
            list-style: none;
        }

        .modal-cost-area,
        #travelRoute_wrap {
            width: auto;
            height: 700px;
            border: 1px solid rgba(0, 0, 0, 0.6);
            background-color: #eee;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
        }

        .cost-header,
        .travelRoute-header {
            cursor: default;
            width: 100%;
            height: 80px;
            padding: 10px;
            background-color: #e2e2e2;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;

        }

        .cost-header .chTitle,
        .travelRoute-header .trTitle {
            font-size: 23px;
            font-weight: 700;
        }

        .cost-header .chBody,
        .travelRoute-header .trBody {
            font-size: 15px;
        }

        .cost-body,
        .travelRoute {
            width: 100%;
            height: 100%;
            padding: 0px 10px 10px;
            overflow: auto;
        }

        .costItem,
        .travelPoint {
            cursor: default;
            padding: 10px 0 5px;
            border-bottom: 1px dashed rgba(0, 0, 0, 0.2);
        }

        .costItem-header span {
            font-size: 30px;
            font-family: 'East Sea Dokdo', cursive;
        }

        .costItem-body ul {
            padding: 0 5px 0 20px;
            list-style-type: circle;
        }

        .costItem-body li {
            font-size: 12px;
        }

        < !--bootstrap customize-->.row {
            width: 100%;
        }

        .btn-group-sm>.btn,
        .btn-sm {
            font-size: 8px;
        }

        .form-control-sm {
            font-size: 10px;
        }



        .btn-warning {
            box-sizing: content-box;
            font-size: 2px;
            padding-top: 0px;
            padding-bottom: 0px;
            padding-left: 0px;
            padding-right: 0px;
            width: 10px;
            height: 10px;
        }

    </style>
</head>

<body>






    <div class="container">
        <div id="edit_right">
            <form id="form1" runat="server" action="Write_get.aspx">
                <input type="hidden" name="sendEmail" value="ok" />
                <div class="row">
                    <div class="col-sm">
                        <div class="form-group">
                            <asp:TextBox ID="title" runat="server" CssClass="form-control form-control-lg" placeholder="ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"></asp:TextBox>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm">
                        <div id="travelRoute_wrap">
                            <div class="travelRoute-header">
                                <span class="trTitle">ì—¬í–‰ì§€</span>
                                <span class="trBody" id="trBody">ë°©ë¬¸ : 0</span>
                            </div>
                            <ul id="travelRoute" class="travelRoute">
                            </ul>

                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="map_wrap">
                            <div id="drawingMap"></div>
                        </div>
                    </div>
                    <div class="col-sm">
                        <div id="travelCost_wrap">
                            <div class="modal-cost">
                                <div class="modal-cost-area">
                                    <div class="cost-header" id="costHeader">
                                        <span class="chTitle">ì „ì²´ ê²½ë¹„</span>
                                        <span class="chBody">ğŸ’° 0</span>
                                    </div>
                                    <div class="cost-body" id="costBody">
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="row">
                    <div class="col-">
                        <!--í¼ ë‚´ë¶€ì—ì„œ ë²„íŠ¼ê°ì²´ë¥¼ ì“°ë ¤ë©´ type=buttonì„ ì¨ì£¼ë©´ ëœë‹¤.-->
                        <button type="button" class="btn btn-secondary" onclick="selectOverlay('MARKER')">ë§ˆì»¤</button>
                        <button type="button" class="btn btn-secondary" onclick="selectOverlay('POLYLINE')">ì„ </button>
                        <button type="button" class="btn btn-secondary" onclick="selectOverlay('CIRCLE')">ì›</button>
                        <button type="button" class="btn btn-secondary" onclick="selectOverlay('RECTANGLE')">ì‚¬ê°í˜•</button>
                        <button type="button" class="btn btn-secondary" onclick="selectOverlay('POLYGON')">ë‹¤ê°í˜•</button>
                        <button type="button" class="btn btn-secondary" onclick="selectOverlay('ELLIPSE')">íƒ€ì›</button>
                        <button type="button" class="btn btn-secondary" onclick="selectOverlay('ARROW')">í™”ì‚´í‘œ</button>
                        <button type="button" class="btn btn-secondary" id="undo" onclick="undoAction()" disabled>UNDO</button>
                        <button type="button" class="btn btn-secondary" id="redo" onclick="redoAction()" disabled>REDO</button>
                        <!-- Button trigger modal -->
                        <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#searchPlaceModal">
                            ê²€ìƒ‰
                        </button>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm">
                        <div class="form-group">
                            <asp:TextBox ID="article" runat="server" TextMode="MultiLine" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm">
                        <div class="form-group">
                            <asp:TextBox ID="hashtag" runat="server" CssClass="form-control form-control-lg" placeholder="#í•´ì‹œíƒœê·¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"></asp:TextBox>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm">
                        <div class="form-group">
                            <input type="button" onclick="postToNext()" value="ë„˜ê¸°ê¸°" />
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="searchPlaceModal" tabindex="-1" role="dialog" aria-labelledby="searchPlaceModalTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="searchPlaceModalTitle">ì¥ì†Œ ê²€ìƒ‰</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="menu_wrap" class="bg_white">
                        <div class="option">
                            <div>
                                í‚¤ì›Œë“œ :
                                <input id="keyword" value="ì´íƒœì› ë§›ì§‘" type="text" />
                                <button onclick="searchPlaces();">ê²€ìƒ‰í•˜ê¸°</button>
                            </div>
                        </div>
                        <hr />
                        <ul id="placesList"></ul>
                        <div id="pagination"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>





    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bs4-summernote@0.8.10/dist/summernote-bs4.min.js"></script>
    <script>
        $(document).ready(function() {
            $('textarea').summernote({
                height: 300, //set editable area's height
            });
        });

    </script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=ebcd0c1accbe0ff4bbb47bd777ef2fcf&libraries=service&libraries=services,clusterer,drawing"></script>

    <script>
        // Drawing Managerë¡œ ë„í˜•ì„ ê·¸ë¦´ ì§€ë„ div
        var drawingMapContainer = document.getElementById('drawingMap'),
            drawingMap = {
                center: new daum.maps.LatLng(33.450701, 126.570667), // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
                level: 3 // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨
            };

        // ì§€ë„ë¥¼ í‘œì‹œí•  divì™€  ì§€ë„ ì˜µì…˜ìœ¼ë¡œ  ì§€ë„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
        //var drawingMap = new daum.maps.Map(drawingMapContainer, mapOption);
        var drawingMap = new daum.maps.Map(drawingMapContainer, drawingMap);

        var options = { // Drawing Managerë¥¼ ìƒì„±í•  ë•Œ ì‚¬ìš©í•  ì˜µì…˜ì…ë‹ˆë‹¤
            map: drawingMap, // Drawing Managerë¡œ ê·¸ë¦¬ê¸° ìš”ì†Œë¥¼ ê·¸ë¦´ map ê°ì²´ì…ë‹ˆë‹¤
            drawingMode: [ // Drawing Managerë¡œ ì œê³µí•  ê·¸ë¦¬ê¸° ìš”ì†Œ ëª¨ë“œì…ë‹ˆë‹¤
                daum.maps.drawing.OverlayType.ARROW,
                daum.maps.drawing.OverlayType.CIRCLE,
                daum.maps.drawing.OverlayType.ELLIPSE,
                daum.maps.drawing.OverlayType.MARKER,
                daum.maps.drawing.OverlayType.POLYLINE,
                daum.maps.drawing.OverlayType.POLYGON,
                daum.maps.drawing.OverlayType.RECTANGLE
            ],
            // ì‚¬ìš©ìì—ê²Œ ì œê³µí•  ê·¸ë¦¬ê¸° ê°€ì´ë“œ íˆ´íŒì…ë‹ˆë‹¤
            // ì‚¬ìš©ìì—ê²Œ ë„í˜•ì„ ê·¸ë¦´ë•Œ, ë“œë˜ê·¸í• ë•Œ, ìˆ˜ì •í• ë•Œ ê°€ì´ë“œ íˆ´íŒì„ í‘œì‹œí•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤
            guideTooltip: ['draw', 'drag', 'edit'],
            arrowOptions: {
                draggable: true,
                removable: false,
                editable: true,
                strokeWeight: 3,
                strokeOpacity: 0.8,
                strokeColor: '#39f',
                strokeStyle: 'solid',
                hintStrokeStyle: 'dashdot',
                hintStrokeOpacity: 0.3,
                startArrow: false
            },
            circleOptions: {
                draggable: true,
                removable: false,
                editable: true,
                strokeColor: '#39f',
                fillColor: '#39f',
                fillOpacity: 0.5
            },
            ellipseOptions: {
                draggable: true,
                removable: false,
                editable: true,
                strokeWeight: 2,
                strokeOpacity: 0.8,
                strokeColor: '#39f',
                strokeStyle: 'solid',
                fillColor: '#39f',
                fillOpacity: 0.3
            },
            markerOptions: { // ë§ˆì»¤ ì˜µì…˜ì…ë‹ˆë‹¤ 
                draggable: true, // ë§ˆì»¤ë¥¼ ê·¸ë¦¬ê³  ë‚˜ì„œ ë“œë˜ê·¸ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤ 
                removable: false // ë§ˆì»¤ë¥¼ ì‚­ì œ í•  ìˆ˜ ìˆë„ë¡ x ë²„íŠ¼ì´ í‘œì‹œë©ë‹ˆë‹¤  
            },
            polylineOptions: { // ì„  ì˜µì…˜ì…ë‹ˆë‹¤
                draggable: true, // ê·¸ë¦° í›„ ë“œë˜ê·¸ê°€ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤
                removable: false, // ê·¸ë¦° í›„ ì‚­ì œ í•  ìˆ˜ ìˆë„ë¡ x ë²„íŠ¼ì´ í‘œì‹œë©ë‹ˆë‹¤
                editable: true, // ê·¸ë¦° í›„ ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤ 
                strokeColor: '#39f', // ì„  ìƒ‰
                hintStrokeStyle: 'dash', // ê·¸ë¦¬ì¤‘ ë§ˆìš°ìŠ¤ë¥¼ ë”°ë¼ë‹¤ë‹ˆëŠ” ë³´ì¡°ì„ ì˜ ì„  ìŠ¤íƒ€ì¼
                hintStrokeOpacity: 0.5 // ê·¸ë¦¬ì¤‘ ë§ˆìš°ìŠ¤ë¥¼ ë”°ë¼ë‹¤ë‹ˆëŠ” ë³´ì¡°ì„ ì˜ íˆ¬ëª…ë„
            },
            polygonOptions: {
                draggable: true,
                removable: false,
                editable: true,
                strokeColor: '#39f',
                fillColor: '#39f',
                fillOpacity: 0.5,
                hintStrokeStyle: 'dash',
                hintStrokeOpacity: 0.5
            },
            rectangleOptions: {
                draggable: true,
                removable: false,
                editable: true,
                strokeColor: '#39f', // ì™¸ê³½ì„  ìƒ‰
                fillColor: '#39f', // ì±„ìš°ê¸° ìƒ‰
                fillOpacity: 0.5 // ì±„ìš°ê¸°ìƒ‰ íˆ¬ëª…ë„
            }

        };

        // ìœ„ì— ì‘ì„±í•œ ì˜µì…˜ìœ¼ë¡œ Drawing Managerë¥¼ ìƒì„±í•©ë‹ˆë‹¤
        var manager = new daum.maps.drawing.DrawingManager(options);

        // undo, redo ë²„íŠ¼ì˜ disabled ì†ì„±ì„ ì„¤ì •í•˜ê¸° ìœ„í•´ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ë³€ìˆ˜ì— ì„¤ì •í•©ë‹ˆë‹¤
        var undoBtn = document.getElementById('undo');
        var redoBtn = document.getElementById('redo');

        // Drawing Manager ê°ì²´ì— state_changed ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤
        // state_changed ì´ë²¤íŠ¸ëŠ” ê·¸ë¦¬ê¸° ìš”ì†Œì˜ ìƒì„±/ìˆ˜ì •/ì´ë™/ì‚­ì œ ë™ì‘ 
        // ë˜ëŠ” Drawing Managerì˜ undo, redo ë©”ì†Œë“œê°€ ì‹¤í–‰ëì„ ë•Œ ë°œìƒí•©ë‹ˆë‹¤
        manager.addListener('state_changed', function() {

            // ë˜ëŒë¦´ ìˆ˜ ìˆë‹¤ë©´ undo ë²„íŠ¼ì„ í™œì„±í™” ì‹œí‚µë‹ˆë‹¤ 
            if (manager.undoable()) {
                undoBtn.disabled = false;

            } else { // ì•„ë‹ˆë©´ undo ë²„íŠ¼ì„ ë¹„í™œì„±í™” ì‹œí‚µë‹ˆë‹¤ 
                undoBtn.disabled = true;
            }

            // ì·¨ì†Œí•  ìˆ˜ ìˆë‹¤ë©´ redo ë²„íŠ¼ì„ í™œì„±í™” ì‹œí‚µë‹ˆë‹¤ 
            if (manager.redoable()) {
                redoBtn.disabled = false;
            } else { // ì•„ë‹ˆë©´ redo ë²„íŠ¼ì„ ë¹„í™œì„±í™” ì‹œí‚µë‹ˆë‹¤ 
                redoBtn.disabled = true;
            }

        });


        // ë²„íŠ¼ í´ë¦­ ì‹œ í˜¸ì¶œë˜ëŠ” í•¸ë“¤ëŸ¬ ì…ë‹ˆë‹¤
        function selectOverlay(type) {
            // ê·¸ë¦¬ê¸° ì¤‘ì´ë©´ ê·¸ë¦¬ê¸°ë¥¼ ì·¨ì†Œí•©ë‹ˆë‹¤
            manager.cancel();

            // í´ë¦­í•œ ê·¸ë¦¬ê¸° ìš”ì†Œ íƒ€ì…ì„ ì„ íƒí•©ë‹ˆë‹¤
            manager.select(daum.maps.drawing.OverlayType[type]);
        }



        // undo ë²„íŠ¼ í´ë¦­ì‹œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
        function undoAction() {
            // ê·¸ë¦¬ê¸° ìš”ì†Œë¥¼ ì´ì „ ìƒíƒœë¡œ ë˜ëŒë¦½ë‹ˆë‹¤
            manager.undo();
        }

        // redo ë²„íŠ¼ í´ë¦­ì‹œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
        function redoAction() {
            // ì´ì „ ìƒíƒœë¡œ ë˜ëŒë¦° ìƒíƒœë¥¼ ì·¨ì†Œí•©ë‹ˆë‹¤
            manager.redo();
        }





        // drawManagerì˜ ìƒíƒœê°€ ë³€ê²½ë˜ê³ 
        // travelRouteì™€ ë³€ê²½
        manager.addListener('state_changed', function() {
            //console.info("state_changed++++++++++++++++++++++++");
            closeCusOverlay();
            //console.info(this._historyStroage);
            refreshOverlayListener();


        });
        // e ëŠ” ì‚­ì œë˜ëŠ” ëŒ€ìƒ ì˜¤ë²„ë ˆì´ê°€ ì‚­ì œë ë•Œ listener ì‚­ì œ
        // ëŒ€ìƒì´ ì‚­ì œë˜ë©´ listener ë„ ê°™ì´ ì‚­ì œë¨
        // ì• ì´ˆì— ë¦¬ìŠ¤ë„ˆê°€ ExtenedMarkerì˜ ë¶€ë¶„ ìš”ì†Œë¡œ ë“¤ì–´ê°€ê¸° ë•Œë¬¸ì—
        // ê°™ì´ ì‚­ì œë¨
        manager.addListener('remove', function(e) {

        });



        function refreshOverlayListener() {
            var data = manager.getOverlays();
            var overlayType = ["circle", "ellipse", "marker", "polygon", "rectangle"];
            overlayType.forEach(function(overlay, overlayIndex, overlayArray) {
                // ê° ì˜¤ë²„ë ˆì´ë“¤ì€ ê¸¸ì´ê°€ 0ì¸ ë°°ì—´ë¡œ ìµœì´ˆë¶€í„° ì¡´ì œ
                //if (data[overlay] != null) {
                if (data[overlay].length > 0) {
                    //í˜„ì¬ ìƒíƒœì™€ ì´ì „ ìƒíƒœì˜ ì˜¤ë²„ë ˆì´ ê°¯ìˆ˜ê°€ ê°™ë‹¤ë©´ í•´ë‹¹ ë¦¬ìŠ¤íŠ¸ ì „ë¶€ ìƒˆë¡œê³ ì¹¨
                    //console.info(overlay + " : " + data[overlay]._index + "ë¥¼ ìƒˆë¡œ ê³ ì¹¨");
                    data[overlay].forEach(function(value, index, array) {
                        try {
                            //removeListener ì‹œë„
                            // ë¦¬ìŠ¤ë„ˆë¥¼ ë§Œë“œëŠ”ì¤‘ì— ì˜¤ë²„ë ˆì´ë¥¼ ì „ë‹¬
                            kakao.maps.event.removeListener(value, 'click', onClick_overlay(value, false));
                        } catch (exception) {
                            //console.info(exception);
                        } finally {
                            kakao.maps.event.addListener(value, 'click', onClick_overlay(value, true));
                        }

                    });

                }
            });
        }


        //ì£¼ì†Œ - ì¢Œí‘œê°„ ë³€í™˜ ì„œë¹„ìŠ¤ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
        var geocoder = new kakao.maps.services.Geocoder();

        var customOverlay = new kakao.maps.CustomOverlay({
            clickable: true,
            xAnchor: 0.5,
            yAnchor: 1.25,
            zIndex: 3
        });

        function closeCusOverlay() {
            customOverlay.setMap(null);
        }


        //-----------------------------------------------
        // í´ë¦­ì‹œ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸
        //----------------------------------------------
        var onClick_overlay = function(overlay, flag) {
            if (flag == true) {
                console.info(overlay.constructor.name + '_' + overlay._index);
                var wcongnamulX;
                var wcongnamulY;
                //console.info("onClick_overlay");
                //alert(this._index + "ë²ˆì§¸ ë§ˆì»¤" + "\nk : " + this.k + "\nGa : " + this.k.Ga + "\nHa : " + this.k.Ha + '\nMARKER click!');
                //console.info(this);
                //console.info(overlay);
                //---- ì˜¤ë²„ë ˆì´ íƒ€ì…ë§ˆë‹¤ ì¢Œí‘œê°€ ì¡´ì¬í•˜ëŠ” ìœ„ì¹˜ê°€ ë‹¤ë¦„
                if (overlay.constructor.name == "ExtendsMarker") {
                    wcongnamulX = overlay.k.Ga;
                    wcongnamulY = overlay.k.Ha;
                } else if (overlay.constructor.name == "ExtendsCircle") {
                    wcongnamulX = overlay.k.Ga;
                    wcongnamulY = overlay.k.Ha;
                } else if (overlay.constructor.name == "ExtendsRectangle") {
                    //ExtendedRectangle has za{ea,ja,ka,la} as coords
                    wcongnamulY = (overlay.za.ka + overlay.za.la) / 2;
                    wcongnamulX = (overlay.za.ea + overlay.za.ja) / 2;
                } else if (overlay.constructor.name == "ExtendsPolygon") {
                    //ExtendedPolygon has ig{0: {ga: ha:}, }
                    var gaTotal = 0;
                    var haTotal = 0;
                    overlay.Ig.forEach(function(value, index, array) {
                        gaTotal += value.Ga;
                        haTotal += value.Ha;
                    });
                    wcongnamulX = gaTotal / overlay.Ig.length;
                    wcongnamulY = haTotal / overlay.Ig.length;
                } else if (overlay.constructor.name == "ExtendsEllipse") {
                    wcongnamulX = overlay.k.Ga;
                    wcongnamulY = overlay.k.Ha;
                }

                //----ì¢Œí‘œê°’ìœ¼ë¡œ ì£¼ì†Œë¥¼ ê°€ì ¸ì˜´
                geocoder.coord2Address(wcongnamulX, wcongnamulY, function(result, status) {


                    if (status === kakao.maps.services.Status.OK) {
                        //console.info(result);

                        var content = "<div>ok</div>";
                        var keyword = document.getElementById('keyword');



                        //ì£¼ì†Œê°€ ìˆë‹¤ë©´ ê²€ìƒ‰
                        if (result[0].address != null) {
                            if (result[0].address.address_name != null) {
                                //                                keyword.value = result[0].address.address_name;
                                //                                //
                                //                                ps.keywordSearch(keyword.value, placesSearchByStateChange);
                                //                                $('#searchPlaceModal').modal('show');

                                content =
                                    var content =
                                        '<div class="card">' +
                                        '<div class="card-header">' +
                                        place.place_name +
                                        '<div class="btn btn-link" onclick="closeOverlay()" title="ë‹«ê¸°" style="float: right">X</div>' +
                                        '</div>' +
                                        '<blockquote class="blockquote mb-0">';

                                if (place.road_address_name != null) {
                                    content += '<li class="card-body-li">' + result[0].address.address_name + '</li>';
                                }
                                '<div class="btn btn-secondary" onclick=\'pushTravelRouteItem("","","","","","' + wcongnamulX + '","' + wcongnamulY + '")\'>ì¶”ê°€</div>' +
                                    '<div class="btn btn-secondary" onclick=\'pushTravelRouteItem("' + place.place_name + '","' + place.road_address_name + '","' + place.ddress_name + '","' + place.phone + '","' + place.place_url + '","' + place.x + '","' + place.y + '")\'>ì£¼ë³€ê²€ìƒ‰</div>' +
                                    '</blockquote>' +
                                    '</div>';


                            }
                        }
                        //                    if (result[0].road_address != null) {
                        //                        if (result[0].road_address.address_name != null) {
                        //                            content += '<li class="card-body-li">' + result[0].road_address.address_name + '</li>';
                        //                        }
                        //                    }
                        //                    address:
                        //                        address_name: "ì„œìš¸ ìš©ì‚°êµ¬ í•œë‚¨ë™ 726-111"
                        //                    main_address_no: "726"
                        //                    mountain_yn: "N"
                        //                    region_1depth_name: "ì„œìš¸"
                        //                    region_2depth_name: "ìš©ì‚°êµ¬"
                        //                    region_3depth_name: "í•œë‚¨ë™"
                        //                    sub_address_no: "111"
                        //                    zip_code: ""
                        //                    __proto__: Object
                        //                    road_address:
                        //                        address_name: "ì„œìš¸íŠ¹ë³„ì‹œ ìš©ì‚°êµ¬ í•œë‚¨ëŒ€ë¡œ36ê¸¸ 54"
                        //                    building_name: "í•œë‚¨íì‚¬ì´ë“œ ì•„íŒŒíŠ¸ Dë™"
                        //                    main_building_no: "54"
                        //                    region_1depth_name: "ì„œìš¸"
                        //                    region_2depth_name: "ìš©ì‚°êµ¬"
                        //                    region_3depth_name: ""
                        //                    road_name: "í•œë‚¨ëŒ€ë¡œ36ê¸¸"
                        //                    sub_building_no: ""
                        //                    underground_yn: "N"
                        //                    zone_no: "04417





                        geocoder.transCoord(wcongnamulX, wcongnamulY,
                            function(result, status) {

                                // ì •ìƒì ìœ¼ë¡œ ê²€ìƒ‰ì´ ì™„ë£Œëìœ¼ë©´ 
                                if (status === kakao.maps.services.Status.OK) {
                                    customOverlay.setPosition(new kakao.maps.LatLng(result[0].y, result[0].x));
                                    customOverlay.setContent(content);
                                    customOverlay.setMap(drawingMap);
                                }
                            }, {
                                input_coord: kakao.maps.services.Coords.WCONGNAMUL, // ë³€í™˜ì„ ìœ„í•´ ì…ë ¥í•œ ì¢Œí‘œê³„ ì…ë‹ˆë‹¤
                                output_coord: kakao.maps.services.Coords.WGS84 // ë³€í™˜ ê²°ê³¼ë¡œ ë°›ì„ ì¢Œí‘œê³„ ì…ë‹ˆë‹¤ 
                            });

                    }
                }, {
                    input_coord: kakao.maps.services.Coords.WCONGNAMUL
                });

            }
        }


       



        // ê²€ìƒ‰ ì‹œìŠ¤í…œ



        var find_markers = [];


        var ps = new kakao.maps.services.Places();

        // ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ì´ë‚˜ ë§ˆì»¤ë¥¼ í´ë¦­í–ˆì„ ë•Œ ì¥ì†Œëª…ì„ í‘œì¶œí•  ì¸í¬ìœˆë„ìš°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
        var infowindow = new kakao.maps.InfoWindow({
            zIndex: 1
        });

        // í‚¤ì›Œë“œë¡œ ì¥ì†Œë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤
        searchPlaces();

        // í‚¤ì›Œë“œ ê²€ìƒ‰ì„ ìš”ì²­í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function searchPlaces() {

            var keyword = document.getElementById('keyword').value;

            if (!keyword.replace(/^\s+|\s+$/g, '')) {
                alert('í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return false;
            }

            // ì¥ì†Œê²€ìƒ‰ ê°ì²´ë¥¼ í†µí•´ í‚¤ì›Œë“œë¡œ ì¥ì†Œê²€ìƒ‰ì„ ìš”ì²­í•©ë‹ˆë‹¤
            ps.keywordSearch(keyword, placesSearchCB);
        }
        
        // í‚¤ì›Œë“œ(ì£¼ì†Œë¥¼ í†µí•´ì„œ ) ì£¼ë³€ ê²€ìƒ‰ì„ ìš”ì²­í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function searchPlacesByAddress() {

            var keyword = document.getElementById('keyword').value;

            if (!keyword.replace(/^\s+|\s+$/g, '')) {
                alert('í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return false;
            }

            // ì¥ì†Œê²€ìƒ‰ ê°ì²´ë¥¼ í†µí•´ í‚¤ì›Œë“œë¡œ ì¥ì†Œê²€ìƒ‰ì„ ìš”ì²­í•©ë‹ˆë‹¤
            ps.keywordSearch(keyword, placesSearchCB);
        }
        
       


        // ì¥ì†Œê²€ìƒ‰ì´ ì™„ë£Œëì„ ë•Œ í˜¸ì¶œë˜ëŠ” ì½œë°±í•¨ìˆ˜ ì…ë‹ˆë‹¤
        function placesSearchCB(data, status, pagination) {
            if (status === kakao.maps.services.Status.OK) {

                // ì •ìƒì ìœ¼ë¡œ ê²€ìƒ‰ì´ ì™„ë£Œëìœ¼ë©´
                // ê²€ìƒ‰ ëª©ë¡ê³¼ ë§ˆì»¤ë¥¼ í‘œì¶œí•©ë‹ˆë‹¤
                displayPlaces(data);

                // í˜ì´ì§€ ë²ˆí˜¸ë¥¼ í‘œì¶œí•©ë‹ˆë‹¤
                displayPagination(pagination);

            } else if (status === kakao.maps.services.Status.ZERO_RESULT) {

                //alert('ê²€ìƒ‰ ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                return;

            } else if (status === kakao.maps.services.Status.ERROR) {

                alert('ê²€ìƒ‰ ê²°ê³¼ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                return;

            }
        }






        // ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ê³¼ ë§ˆì»¤ë¥¼ í‘œì¶œí•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function displayPlaces(places) {

            var listEl = document.getElementById('placesList'),
                menuEl = document.getElementById('menu_wrap'),
                fragment = document.createDocumentFragment(),
                bounds = new kakao.maps.LatLngBounds(),
                listStr = '';


            // ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ì— ì¶”ê°€ëœ í•­ëª©ë“¤ì„ ì œê±°í•©ë‹ˆë‹¤
            removeAllChildNods(listEl);

            // ì§€ë„ì— í‘œì‹œë˜ê³  ìˆëŠ” ë§ˆì»¤ë¥¼ ì œê±°í•©ë‹ˆë‹¤
            removeMarker();

            for (var i = 0; i < places.length; i++) {

                // ë§ˆì»¤ë¥¼ ìƒì„±í•˜ê³  ì§€ë„ì— í‘œì‹œí•©ë‹ˆë‹¤
                var placePosition = new kakao.maps.LatLng(places[i].y, places[i].x),
                    marker = addMarker(placePosition, i),
                    itemEl = getListItem(i, places[i]); // ê²€ìƒ‰ ê²°ê³¼ í•­ëª© Elementë¥¼ ìƒì„±í•©ë‹ˆë‹¤

                // ê²€ìƒ‰ëœ ì¥ì†Œ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§€ë„ ë²”ìœ„ë¥¼ ì¬ì„¤ì •í•˜ê¸°ìœ„í•´
                // LatLngBounds ê°ì²´ì— ì¢Œí‘œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤
                bounds.extend(placePosition);

                // ë§ˆì»¤ì™€ ê²€ìƒ‰ê²°ê³¼ í•­ëª©ì— mouseover í–ˆì„ë•Œ
                // í•´ë‹¹ ì¥ì†Œì— ì¸í¬ìœˆë„ìš°ì— ì¥ì†Œëª…ì„ í‘œì‹œí•©ë‹ˆë‹¤
                // mouseout í–ˆì„ ë•ŒëŠ” ì¸í¬ìœˆë„ìš°ë¥¼ ë‹«ìŠµë‹ˆë‹¤
                (function(marker, place) {
                    kakao.maps.event.addListener(marker, 'click', function() {
                        displayInfowindow(marker, place);
                    });

                    itemEl.onmouseover = function() {
                        displayInfowindow(marker, place);
                    };

                    itemEl.onmouseclick = function() {
                        displayInfowindow(marker, place);
                        $('#searchPlaceModal').modal('hide');

                    };

                })(marker, places[i]);

                fragment.appendChild(itemEl);
            }

            // ê²€ìƒ‰ê²°ê³¼ í•­ëª©ë“¤ì„ ê²€ìƒ‰ê²°ê³¼ ëª©ë¡ Elemnetì— ì¶”ê°€í•©ë‹ˆë‹¤
            listEl.appendChild(fragment);
            menuEl.scrollTop = 0;

            // ê²€ìƒ‰ëœ ì¥ì†Œ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§€ë„ ë²”ìœ„ë¥¼ ì¬ì„¤ì •í•©ë‹ˆë‹¤
            //map.setBounds(bounds);
            drawingMap.setBounds(bounds);
        }

        class Place {
            constructor(place_name, road_address_name, address_name, phone, place_url, x, y) {
                this.place_name = place_name;
                this.road_address_name = road_address_name;
                this.address_name = address_name;
                this.phone = phone;
                this.place_url = place_url;
                this.x = x;
                this.y = y;
            }
            setRoute(place_name, road_address_name, address_name, phone, place_url, x, y) {

                this.place_name = place_name;
                this.road_address_name = road_address_name;
                this.address_name = address_name;
                this.phone = phone;
                this.place_url = place_url;
                this.x = x;
                this.y = y;
            }
        }

        var CurPlaceList = Array();



        // ê²€ìƒ‰ê²°ê³¼ í•­ëª©ì„ Elementë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function getListItem(index, places) {

            var el = document.createElement('li'),
                itemStr = '<span class="markerbg marker_' + (index + 1) + '"></span>' +
                '<div class="info">' +
                '   <h5 data-dismiss="modal">' + places.place_name + '</h5>';

            if (places.road_address_name) {
                itemStr += '    <span data-dismiss="modal">' + places.road_address_name + '</span>' +
                    '   <span class="jibun gray" data-dismiss="modal">' + places.address_name + '</span>';
            } else {
                itemStr += '    <span data-dismiss="modal">' + places.address_name + '</span>';
            }

            itemStr += '  <span class="tel">' + places.phone + '</span>' +
                '</div>';

            el.innerHTML = itemStr;
            el.className = 'item';

            return el;
        }

        // ë§ˆì»¤ë¥¼ ìƒì„±í•˜ê³  ì§€ë„ ìœ„ì— ë§ˆì»¤ë¥¼ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function addMarker(position, idx, title) {
            var imageSrc = 'http://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_number_blue.png', // ë§ˆì»¤ ì´ë¯¸ì§€ url, ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ë¥¼ ì”ë‹ˆë‹¤
                imageSize = new kakao.maps.Size(36, 37), // ë§ˆì»¤ ì´ë¯¸ì§€ì˜ í¬ê¸°
                imgOptions = {
                    spriteSize: new kakao.maps.Size(36, 691), // ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ì˜ í¬ê¸°
                    spriteOrigin: new kakao.maps.Point(0, (idx * 46) + 10), // ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ ì¤‘ ì‚¬ìš©í•  ì˜ì—­ì˜ ì¢Œìƒë‹¨ ì¢Œí‘œ
                    offset: new kakao.maps.Point(13, 37) // ë§ˆì»¤ ì¢Œí‘œì— ì¼ì¹˜ì‹œí‚¬ ì´ë¯¸ì§€ ë‚´ì—ì„œì˜ ì¢Œí‘œ
                },
                markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imgOptions),
                marker = new kakao.maps.Marker({
                    position: position, // ë§ˆì»¤ì˜ ìœ„ì¹˜
                    image: markerImage
                });

            marker.setMap(drawingMap); // ì§€ë„ ìœ„ì— ë§ˆì»¤ë¥¼ í‘œì¶œí•©ë‹ˆë‹¤
            find_markers.push(marker); // ë°°ì—´ì— ìƒì„±ëœ ë§ˆì»¤ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤

            return marker;
        }

        // ì§€ë„ ìœ„ì— í‘œì‹œë˜ê³  ìˆëŠ” ë§ˆì»¤ë¥¼ ëª¨ë‘ ì œê±°í•©ë‹ˆë‹¤
        function removeMarker() {
            for (var i = 0; i < find_markers.length; i++) {
                find_markers[i].setMap(null);
            }
            find_markers = [];
        }

        // ê²€ìƒ‰ê²°ê³¼ ëª©ë¡ í•˜ë‹¨ì— í˜ì´ì§€ë²ˆí˜¸ë¥¼ í‘œì‹œëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function displayPagination(pagination) {
            var paginationEl = document.getElementById('pagination'),
                fragment = document.createDocumentFragment(),
                i;

            // ê¸°ì¡´ì— ì¶”ê°€ëœ í˜ì´ì§€ë²ˆí˜¸ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤
            while (paginationEl.hasChildNodes()) {
                paginationEl.removeChild(paginationEl.lastChild);
            }

            for (i = 1; i <= pagination.last; i++) {
                var el = document.createElement('a');
                el.href = "#";
                el.innerHTML = i;

                if (i === pagination.current) {
                    el.className = 'on';
                } else {
                    el.onclick = (function(i) {
                        return function() {
                            pagination.gotoPage(i);
                        }
                    })(i);
                }

                fragment.appendChild(el);
            }
            paginationEl.appendChild(fragment);
        }

        // ê²€ìƒ‰ê²°ê³¼ ëª©ë¡ ë˜ëŠ” ë§ˆì»¤ë¥¼ í´ë¦­í–ˆì„ ë•Œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        // ì¸í¬ìœˆë„ìš°ì— ì¥ì†Œëª…ì„ í‘œì‹œí•©ë‹ˆë‹¤
        function displayInfowindow(marker, place) {





            var content =
                '<div class="card">' +
                '<div class="card-header">' +
                place.place_name +
                '<div class="btn btn-link" onclick="closeOverlay()" title="ë‹«ê¸°" style="float: right">X</div>' +
                '</div>' +
                '<blockquote class="blockquote mb-0">';

            if (place.road_address_name != null) {
                content += '<li class="card-body-li">' + place.road_address_name + '</li>';
            }
            if (place.address_name != null) {
                content += '<li class="card-body-li">' + place.address_name + '</li>';
            }
            if (place.phone != null) {
                content += '<li class="card-body-li">' + place.phone + '</li>';
            }
            if (place.place_url != null) {
                content += '<li class="card-body-li"><a href="' + place.place_url + '" target="_blank" class="link">ìƒì„¸í˜ì´ì§€</a></li>';
            }
            '<div class="btn btn-secondary" onclick=\'pushTravelRouteItem("' + place.place_name + '","' + place.road_address_name + '","' + place.ddress_name + '","' + place.phone + '","' + place.place_url + '","' + place.x + '","' + place.y + '")\'>ì—¬í–‰ê²½ë¡œì— ì¶”ê°€</div>' +
                '</blockquote>' +
                '</div>';

            infowindow.setContent(content);
            infowindow.open(drawingMap, marker);
        }
        // ëª¨ë“  ì¸í¬ìœˆë„ìš° ë‹«ìŒ
        function closeOverlay() {
            infowindow.close();
        }


        // ê²€ìƒ‰ê²°ê³¼ ëª©ë¡ì˜ ìì‹ Elementë¥¼ ì œê±°í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function removeAllChildNods(el) {
            while (el.hasChildNodes()) {
                el.removeChild(el.lastChild);
            }
        }

        //------------------------------------
        //----------TravelRouteItem and travelRouteList Start
        //------------------------------------

        class TravelRouteItem {
            constructor(place_name, road_address_name, address_name, phone, place_url, x, y) {
                this.place_name = place_name;
                this.road_address_name = road_address_name;
                this.address_name = address_name;
                this.phone = phone;
                this.place_url = place_url;
                this.x = x;
                this.y = y;
                this.info = "";

            }
            setRoute(place_name, road_address_name, address_name, phone, place_url, x, y) {

                this.place_name = place_name;
                this.road_address_name = road_address_name;
                this.address_name = address_name;
                this.phone = phone;
                this.place_url = place_url;
                this.x = x;
                this.y = y;

            }
            setName(place_name) {
                this.place_name = place_name;
            }
            setInfo(info) {
                this.info = info;
            }

        }

        var TravelRouteList = Array();

        function refreashTravelRoute() {

            var travelRouteUl = document.getElementById('travelRoute'),
                trBody = document.getElementById('trBody'),
                fragment = document.createDocumentFragment(),
                itemList = '',
                el;

            ;

            // costBody ëª¨ë“  ìì‹ ë…¸ë“œ ì‚­ì œ
            while (travelRouteUl.hasChildNodes()) {
                travelRouteUl.removeChild(travelRouteUl.firstChild);
            }
            TravelRouteList.forEach(function(currentValue, index) {

                ////console.info(index);
                ////console.info(currentValue);
                el = document.createElement('li'),
                    itemStr =

                    '<div class="travelRouteItem-header">' +
                    ' <div class="form-group">' +
                    ' <table>' +
                    ' <tr>' +
                    ' <td>' +
                    ' <input id="addTravelRoute_place_name_' + index + '" class="form-control form-control-sm" type="text" placeholder="ì¥ì†Œ ì´ë¦„" value="' + currentValue.place_name + '" style="width:130px;" />' +
                    ' </td>' +
                    ' <td>' +
                    ' <div class="btn btn-secondary btn-sm" onclick="setTravelRouteItemName(' + index + ')">ì´ë¦„ë³€ê²½</div>' +
                    ' </td>' +
                    ' <td>' +
                    ' <div class="btn btn-danger btn-sm" onclick="removeTravelRouteItem(' + index + ')"> x </div>' +
                    ' </td>' +
                    ' </tr>' +
                    '</table>' +
                    ' </div>' +
                    '</div>' +
                    ' <div>' +
                    '<table>' +
                    '<tr>' +
                    '<td>' +
                    ' <textarea id="addTravelRoute_info_' + index + '" class="form-control form-control-sm" type="text" placeholder="ì„¤ëª…" rows="3" >' + currentValue.info + '</textarea>' +
                    '</td>' +
                    '<td style="vertical-align:top">' +
                    ' <div class="btn btn-secondary btn-sm" onclick="setTravelRouteItemInfo(' + index + ')" >ì„¤ëª…ì €ì¥</div>' +
                    '</td>' +
                    '</tr>' +
                    '</table>';

                if (currentValue.address_name != "" && currentValue.address_name != "undefined") {
                    itemStr += currentValue.address_name + '<br/>';

                }
                if (currentValue.road_address_name != "" && currentValue.road_address_name != "undefined") {
                    itemStr += currentValue.road_address_name + '<br/>';

                }
                if (currentValue.phone != "" && currentValue.phone != "undefined") {
                    itemStr += currentValue.phone + '<br/>';

                }
                itemStr += '<a class="btn btn-primary btn-sm" href="' + currentValue.place_url + '" target="_blank">ìƒì„¸í˜ì´ì§€</a>';




                itemStr += '</div>';
                el.innerHTML = itemStr;
                el.setAttribute("draggable", 'true');
                el.setAttribute("class", "travelPoint");
                el.setAttribute("id", "travelPoint_" + index);



                var itemEl = el;

                fragment.appendChild(itemEl);

                travelRouteUl.appendChild(fragment);



            });

            var trBodyStr = 'ë°©ë¬¸ : ' + TravelRouteList.length;
            ////console.info(trBody);
            trBody.innerHTML = trBodyStr;


            dragAndDropAction();

        }

        function pushTravelRouteItem(place_name, road_address_name, address_name, phone, place_url, x, y) {

            TravelRouteList.push(new TravelRouteItem(place_name, road_address_name, address_name, phone, place_url, x, y));
            addCostItemParent(place_name);
            refreashTravelRoute();

        }


        function removeTravelRouteItem(index) {
            TravelRouteList.splice(index, 1);
            removeCostItemParent(index);
            refreashTravelRoute();



        }




        function setTravelRouteItem(index, place_name, road_address_name, address_name, phone, place_url, x, y) {


            TravelRouteList[index].setRoute(place_name, road_address_name, address_name, phone, place_url, x, y);
            refreashTravelRoute();
        }

        function setTravelRouteItemName(index) {

            var addTravelRoute_place_nameId = "addTravelRoute_place_name_" + index;
            var place_name = document.getElementById(addTravelRoute_place_nameId).value;
            TravelRouteList[index].setName(place_name);
            refreashTravelRoute();

            setCostItemParentName(index);
        }

        function setTravelRouteItemInfo(index) {

            var addTravelRoute_infoId = "addTravelRoute_info_" + index;
            var info = document.getElementById(addTravelRoute_infoId).value;
            TravelRouteList[index].setInfo(info);
            refreashTravelRoute();

            setCostItemParentName(index);
        }




        function swapTravelRouteItem(fIndex, sIndex) {
            var tmp = TravelRouteList[fIndex];
            TravelRouteList[fIndex] = TravelRouteList[sIndex];
            TravelRouteList[sIndex] = tmp;
            refreashTravelRoute();
        }



        //------------------------------------
        //----------TravelRouteItem and travelRouteList END
        //------------------------------------

        //------------------------------------
        //----------CostItems and CostItemList Start
        //------------------------------------
        class CostItem {
            constructor(place_name) {
                this.itemList = Array();
                this.place_name = place_name;
            }
            setPlace_name(place_name) {
                this.place_name = place_name;
            }
            pushItem(costType, cost, info) {
                this.itemList.push({
                    costType,
                    cost,
                    info
                });
            }
            popItem() {
                this.itemList.pop();
            }
        }

        var CostItemList = Array();



        function button() {

        }


        function refreashCostItem() {

            var costBody = document.getElementById('costBody'),
                costHeader = document.getElementById('costHeader'),
                fragment = document.createDocumentFragment(),
                headerFragment = document.createDocumentFragment(),
                itemList = '',
                el, headerEl, totalCost = 0,
                pindexTmp;

            ;

            // costBody ëª¨ë“  ìì‹ ë…¸ë“œ ì‚­ì œ
            while (costBody.hasChildNodes()) {
                costBody.removeChild(costBody.firstChild);
            }
            CostItemList.forEach(function(currentValue, pindex) {
                pindexTmp = pindex;
                ////console.info(pindex);
                ////console.info(currentValue);
                el = document.createElement('div'),
                    itemStr =

                    '<div class="costItem-header">' +
                    '         <span># ' + currentValue.place_name + '</span>' +
                    '</div>' +
                    '   <div class="costItem-body">' +
                    '       <ul>';

                currentValue.itemList.forEach(function(currentValue, index) {
                    itemStr += '<li>' + currentValue.costType +
                        '               <div class="btn btn-sm btn-warning" onclick="removeCostItemChild(' + pindex + ',' + index + ')">x</div>' +
                        '<br/>' +
                        setComa(currentValue.cost) + ' (' + currentValue.info + ')' + '</li>';
                    totalCost += parseInt(currentValue.cost);
                });

                itemStr +=
                    '<li>' +
                    '   <div class="btn btn-secondary btn-sm" data-toggle="collapse" data-target="#collapseAddCost_' + pindex + '" aria-expanded="false" aria-controls="collapseAddCost_' + pindex + '">ì¶”ê°€</div>' +
                    '   <div class="collapse" id="collapseAddCost_' + pindex + '">' +
                    '       <select id="addCost_costType_' + pindex + '" class="form-control form-control-sm">' +
                    '           <option value="ì‹ë¹„">ì‹ë¹„</option>' +
                    '           <option value="êµí†µë¹„">êµí†µë¹„</option>' +
                    '           <option value="ìˆ™ë°•ë¹„">ìˆ™ë°•ë¹„</option>' +
                    '           <option value="ê¸°íƒ€">ê¸°íƒ€</option>' +
                    '       </select>' +
                    '       <input id="addCost_cost_' + pindex + '" class="form-control form-control-sm" type="number" placeholder="ë¹„ìš©">' +
                    '       <input id="addCost_info_' + pindex + '" class="form-control form-control-sm" type="text" placeholder="ë¹„ìš© ì„¤ëª…">' +
                    '       <div class="btn btn-secondary btn-sm" onclick="pushCostItemChild(' + pindex + ')">+</div>' +
                    '       <div class="btn btn-secondary btn-sm" onclick="popCostItemChild(' + pindex + ')">-</div>' +

                    '</div>' +
                    '</li>' +
                    '   </ul>' +
                    '</div>' +
                    '</div>';
                el.innerHTML = itemStr;
                //            el.setAttribute("draggable", 'true');
                //            el.setAttribute("id", "travelPoint");
                el.setAttribute("class", "costItem");


                var itemEl = el;

                fragment.appendChild(itemEl);

                costBody.appendChild(fragment);



            });

            // ë‚˜ì¤‘ì— ì§€ë„ì˜ travelrouteì—ì„œ ì¶”ê°€í•  ë²„íŠ¼
            //el = document.createElement('div'),
            //    itemStr =

            //    '<div class="btn btn-secondary btn-sm" onclick="addCostItemParent(' + pindexTmp + ')">+</div>';

            //el.innerHTML = itemStr;
            ////            el.setAttribute("draggable", 'true');
            ////            el.setAttribute("id", "travelPoint");
            //el.setAttribute("class", "costItem");


            //var itemEl = el;

            //fragment.appendChild(itemEl);

            //costBody.appendChild(fragment);

            ////--------------------



            var headerStr =
                '<span class="chTitle">ì „ì²´ ê²½ë¹„</span>' +
                '<span class="chBody">ğŸ’° ' + setComa(totalCost) + '</span>';
            costHeader.innerHTML = headerStr;




        }

        function pushCostItemChild(index) {

            var costTypeId = "addCost_costType_" + index,
                costId = "addCost_cost_" + index,
                infoId = "addCost_info_" + index;

            var costType = document.getElementById(costTypeId);
            cost = document.getElementById(costId),
                info = document.getElementById(infoId);

            if (cost.value == "") {

                alert("ë¹„ìš©ì„ ì…ë ¥í•˜ì„¸ìš”");
            } else {

                CostItemList[index].pushItem(costType.options[costType.selectedIndex].value, cost.value, info.value);
                refreashCostItem();
            }



        }


        function popCostItemChild(index) {

            var costTypeId = "addCost_costType_" + index,
                costId = "addCost_cost_" + index,
                infoId = "addCost_info_" + index;

            var costType = document.getElementById(costTypeId);
            cost = document.getElementById(costId),
                info = document.getElementById(infoId);

            CostItemList[index].popItem();
            refreashCostItem();

        }




        function addCostItemParent(place_name) {
            CostItemList.push(new CostItem(place_name));
            refreashCostItem();

        }

        function setCostItemParentName(pindex) {

            //var addCost_place_nameId = "addCost_place_name_" + pindex;
            //var addCost_place_name = document.getElementById(addCost_place_nameId);
            var addTravelRoute_place_nameId = "addTravelRoute_place_name_" + pindex;
            var place_name = document.getElementById(addTravelRoute_place_nameId).value;

            CostItemList[pindex].setPlace_name(place_name);
            refreashCostItem();
        }

        function removeCostItemChild(pindex, index) {
            CostItemList[pindex].itemList.splice(index, 1);
            refreashCostItem();
        }


        function removeCostItemParent(pindex) {
            CostItemList.splice(pindex, 1);
            refreashCostItem();
        }

        function swapCostItemParent(fIndex, sIndex) {
            var tmp = CostItemList[fIndex];
            CostItemList[fIndex] = CostItemList[sIndex];
            CostItemList[sIndex] = tmp;
            refreashCostItem();
        }

        function setComa(number) {
            var resultStr = "";
            var strNumber = String(number);
            ////console.info(strNumber);
            ////console.info(strNumber.length);
            for (var i = strNumber.length - 1; i >= 0; i--) {
                ////console.info(i);

                if ((strNumber.length - i - 1) % 3 == 0 && i != strNumber.length - 1) {
                    resultStr = ',' + resultStr;
                }
                resultStr = strNumber[i] + resultStr;
            }


            return resultStr;

        }

        //------------------------------------
        //----------CostItems and CostItemList End
        //------------------------------------




        //------------------------------------
        //----------DragManager Start
        //------------------------------------





        //ì—¬í–‰ê²½ë¡œ ë“œë˜ê·¸ ì•¤ ë“œë¡­
        var DragManager;

        function dragAndDropAction() {
            //DragMangerì— ìš”ì†Œ ì¶”ê°€ (ì¶”í›„ ë“œë˜ê·¸ ì•¤ë“œë¡­ ì•¡ì…˜ ì‹¤í–‰)
            DragManager = {
                travelRoutes: [],
                currentContainer: null,

                add: function(travelRoute) {
                    this.travelRoutes.push(travelRoute);
                },

                handleEvent: function(event) {
                    ////console.info(event.target);
                    if (event.type == 'dragstart') {
                        //console.info("dragstart");
                        var containers = this.travelRoutes.filter(function(container) {

                            return container.contains(event.target);
                        });

                        if (containers.length > 0) {
                            this.currentContainer = containers[0];
                            this.currentContainer.activate();
                        }
                    }

                    if (this.currentContainer !== null) {
                        this.currentContainer.handleEvent(event);
                        if (event.type == 'dragend') {
                            this.currentContainer.deactivate();
                            this.currentContainer = null;
                        }
                    }
                }

            };

            window.addEventListener('dragstart', DragManager);
            window.addEventListener('dragend', DragManager);

            function travelRoute(container, type) {
                this.element = container;
                this.type = type || 'swap';
                this.items = $('> li', this.element);
                this.draggingItem = null;

                DragManager.add(this);
            }

            travelRoute.prototype.contains = function(target) {
                ////console.info(target);
                return $(this.element).find(target).length;
            }

            travelRoute.prototype.handleEvent = function(event) {
                // NOTE: We've bound `this` to the travelRoute object, not
                // the element the event was fired on.
                var $t = $(event.target);

                if (event.type == 'dragstart') {
                    this.draggingItem = event.target;
                    //console.info(event.target);
                    //setdataì— ìµœìƒìœ„ LIdml HTMLì„ ë°ì´í„°ë¡œ ë³´ë‚¸ë‹¤
                    ////console.info("this.draggingItem");
                    ////console.info(this.draggingItem);
                    var tgtItem = this.draggingItem;
                    while (1) {
                        //if(data.id == "travelPoint")
                        ////console.info("tgtItem.tagName");
                        ////console.info(tgtItem.tagName);
                        //if (tgtItem.tagName == "LI")
                        if (tgtItem.className == "travelPoint")
                            break;
                        tgtItem = tgtItem.parentNode;
                    }


                    event.dataTransfer.setData('text/html', tgtItem.innerHTML);
                }

                if (event.type == 'dragover' && this.draggingItem != event.target) {

                    $t.addClass('js-active');
                    // Preventing the default action _enables_ drop. Because JS APIs.
                    if (event.preventDefault) {
                        event.preventDefault();
                    }
                    event.dataTransfer.dropEffect = 'move';
                }

                if (event.type == 'dragleave') {
                    $t.removeClass('js-active');
                }

                if (event.type == 'drop' && this.draggingItem != null) {
                    if (this.type == 'swap') {


                        // ìµœìƒë‹¨ LIíƒœê·¸ë¥¼ íƒìƒ‰
                        var tgtItem = event.target;
                        while (1) {
                            //if(data.id == "travelPoint")
                            //if (tgtItem.tagName == "LI")
                            if (tgtItem.className == "travelPoint")
                                break;
                            tgtItem = tgtItem.parentNode;
                        }
                        var fIndex, sIndex;
                        //travelPoint_0
                        fIndex = tgtItem.id.slice(12);
                        sIndex = this.draggingItem.id.slice(12);

                        //console.info(fIndex);
                        //console.info(sIndex);
                        swapTravelRouteItem(parseInt(fIndex), parseInt(sIndex));
                        swapCostItemParent(parseInt(fIndex), parseInt(sIndex));
                        //ìµœìƒë‹¨  travelPointë¡œë§Œ ì˜®ê¹€.
                        //this.draggingItem.innerHTML = tgtItem.innerHTML;
                        //tgtItem.innerHTML = event.dataTransfer.getData('text/html');
                    } else if (this.type == 'reorder') {
                        //console.info('reorder');
                        //console.info(this.items.index(event.target));
                    }
                }

                if (event.type == 'dragend' || event.type == 'drop') {
                    this.items.removeClass('js-active');
                    this.draggingItem = null;
                }
            }

            travelRoute.prototype.activate = function() {
                for (var i = 0, j = this.items.length; i < j; i++) {
                    // Make sure `this` is always a travelRoute instead of the element the
                    // event was activated on.
                    this.items[i].addEventListener('dragenter', this.handleEvent.bind(this));
                    this.items[i].addEventListener('dragover', this.handleEvent.bind(this));
                    this.items[i].addEventListener('dragleave', this.handleEvent.bind(this));
                    this.items[i].addEventListener('drop', this.handleEvent.bind(this));
                }
            }

            travelRoute.prototype.deactivate = function() {
                this.draggingItem = null;
                for (var i = 0, j = this.items.length; i < j; i++) {
                    //this.items[i].removeEventListener('dragenter', this.handleEvent);
                    //this.items[i].removeEventListener('dragover', this.handleEvent);
                    //this.items[i].removeEventListener('dragleave', this.handleEvent);
                    //this.items[i].removeEventListener('drop', this.handleEvent);
                }
            }

            var travelRoutes = document.getElementsByClassName('travelRoute');

            for (var i = 0, j = travelRoutes.length; i < j; i++) {
                new travelRoute(travelRoutes[i], (i % 2 == 0) ? 'swap' : 'reorder');
            }

        }
        //------------------------------------
        //----------DragManager END
        //------------------------------------

        //------------------------------------
        //----------Post START
        //------------------------------------





        overlays = []; // ì§€ë„ì— ê·¸ë ¤ì§„ ë„í˜•ì„ ë‹´ì„ ë°°ì—´




        // ë‹¤ìŒí˜ì´ì§€ë¡œ markers, polyline, rect, circle, polygon ë³´ë‚´ëŠ” ê¸°ëŠ¥
        function postToNext() {
            var data = manager.getData();
            //rects  circles   polygons 
            markers = data[daum.maps.drawing.OverlayType.MARKER];
            polylines = data[daum.maps.drawing.OverlayType.POLYLINE];
            rects = data[daum.maps.drawing.OverlayType.RECTANGLE];
            circles = data[daum.maps.drawing.OverlayType.CIRCLE];
            polygons = data[daum.maps.drawing.OverlayType.POLYGON];

            markersPath = [];
            polylinesPath = [];
            rectsPath = [];
            circlesPath = [];
            polygonsPath = [];

            for (var i = 0; i < markers.length; i++) {

                var latlng = new daum.maps.LatLng(markers[i].y, markers[i].x);
                markersPath.push(i + ":");
                markersPath.push(latlng);


            }




            var len = polylines.length,
                i = 0;

            for (; i < len; i++) {
                var path = pointsToPath(polylines[i].points);
                polylinesPath.push(i + ":");
                polylinesPath.push(path);

            }


            var len = circles.length,
                i = 0;

            for (; i < len; i++) {
                circlesPath.push(i + ":");
                circlesPath.push(new daum.maps.LatLng(circles[i].center.y, circles[i].center.x));
                circlesPath.push(circles[i].radius);

            }

            var len = rects.length,
                i = 0;

            for (; i < len; i++) {


                rectsPath.push(i + ":");
                rectsPath.push(rects[i].sPoint.y, rects[i].sPoint.x, rects[i].ePoint.y, rects[i].ePoint.x);


            }

            var len = polygons.length,
                i = 0;

            for (; i < len; i++) {
                var path = pointsToPath(polygons[i].points);
                polygonsPath.push(i + ":");
                polygonsPath.push(path);

            }




            //document.getElementById("marker").value = markersPath;
            //document.getElementById("polygon").value = polylinesPath;
            var title = document.getElementById("title").value;
            var article = document.getElementById("article").value;
            var hashtag = document.getElementById("hashtag").value;


            var form = document.getElementById("form1");




            var insert1 = document.createElement("input"); // input ì—˜ë¦¬ë©˜íŠ¸ ìƒì„±
            insert1.setAttribute("type", "hidden"); // type ì†ì„±ì„ hiddenìœ¼ë¡œ ì„¤ì •
            insert1.setAttribute("name", "marker"); // name ì†ì„±ì„ 'stadium'ìœ¼ë¡œ ì„¤ì •
            insert1.setAttribute("value", markersPath); // value ì†ì„±ì„ ì‚½ì…
            form.appendChild(insert1); // form ì—˜ë¦¬ë©˜íŠ¸ì— input ì—˜ë¦¬ë©˜íŠ¸ ì¶”ê°€

            var insert2 = document.createElement("input"); // input ì—˜ë¦¬ë©˜íŠ¸ ìƒì„±
            insert2.setAttribute("type", "hidden"); // type ì†ì„±ì„ hiddenìœ¼ë¡œ ì„¤ì •
            insert2.setAttribute("name", "polyline"); // name ì†ì„±ì„ 'stadium'ìœ¼ë¡œ ì„¤ì •
            insert2.setAttribute("value", polylinesPath); // value ì†ì„±ì„ ì‚½ì…
            form.appendChild(insert2);
            //rects  circles   polygons 
            var insert3 = document.createElement("input"); // input ì—˜ë¦¬ë©˜íŠ¸ ìƒì„±
            insert3.setAttribute("type", "hidden"); // type ì†ì„±ì„ hiddenìœ¼ë¡œ ì„¤ì •
            insert3.setAttribute("name", "rects"); // name ì†ì„±ì„ 'stadium'ìœ¼ë¡œ ì„¤ì •
            insert3.setAttribute("value", rectsPath); // value ì†ì„±ì„ ì‚½ì…
            form.appendChild(insert3);

            var insert4 = document.createElement("input"); // input ì—˜ë¦¬ë©˜íŠ¸ ìƒì„±
            insert4.setAttribute("type", "hidden"); // type ì†ì„±ì„ hiddenìœ¼ë¡œ ì„¤ì •
            insert4.setAttribute("name", "circles"); // name ì†ì„±ì„ 'stadium'ìœ¼ë¡œ ì„¤ì •
            insert4.setAttribute("value", circlesPath); // value ì†ì„±ì„ ì‚½ì…
            form.appendChild(insert4);

            var insert5 = document.createElement("input"); // input ì—˜ë¦¬ë©˜íŠ¸ ìƒì„±
            insert5.setAttribute("type", "hidden"); // type ì†ì„±ì„ hiddenìœ¼ë¡œ ì„¤ì •
            insert5.setAttribute("name", "polygons"); // name ì†ì„±ì„ 'stadium'ìœ¼ë¡œ ì„¤ì •
            insert5.setAttribute("value", polygonsPath); // value ì†ì„±ì„ ì‚½ì…
            form.appendChild(insert5);

            var insert6 = document.createElement("input"); // input ì—˜ë¦¬ë©˜íŠ¸ ìƒì„±
            insert5.setAttribute("type", "hidden"); // type ì†ì„±ì„ hiddenìœ¼ë¡œ ì„¤ì •
            insert5.setAttribute("name", "data"); // name ì†ì„±ì„ 'stadium'ìœ¼ë¡œ ì„¤ì •
            insert5.setAttribute("value", manager.getData()); // value ì†ì„±ì„ ì‚½ì…
            form.appendChild(insert6);



            form.submit(); // ì „ì†¡
        }


        //------------------------------------
        //----------Post END
        //------------------------------------

    </script>
</body>

</html>
